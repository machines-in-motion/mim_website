 @article{Bogdanovic_Khadiv_Righetti_2022, 
 title={Model-free Reinforcement Learning for Robust Locomotion using Demonstrations from Trajectory Optimization}, 
 url={https://arxiv.org/abs/2107.06629}, 
 DOI={10.3389/frobt.2022.854212}, 
 abstract={We present a general, two-stage reinforcement learning approach to create robust policies that can be deployed on real robots without any additional training using a single demonstration generated by trajectory optimization. The demonstration is used in the first stage as a starting point to facilitate initial exploration. In the second stage, the relevant task reward is optimized directly and a policy robust to environment uncertainties is computed. We demonstrate and examine in detail the performance and robustness of our approach on highly dynamic hopping and bounding tasks on a quadruped robot.}, 
 journal={Frontiers in Robotics and AI}, 
 author={Bogdanovic, Miroslav and Khadiv, Majid and Righetti, Ludovic}, 
 year={2022} 
}
 @article{Daneshmand_Khadiv_Grimminger_Righetti_2021, 
 title={Variable Horizon MPC with Swing Foot Dynamics for Bipedal Walking Control}, 
 volume={6}, 
 url={https://arxiv.org/abs/2010.08198}, 
 DOI={10.1109/LRA.2021.3061381}, 
 abstract={In this paper, we present a novel two-level variable Horizon Model Predictive Control (VH-MPC) framework for bipedal locomotion. In this framework, the higher level computes the landing location and timing (horizon length) of the swing foot to stabilize the unstable part of the center of mass (CoM) dynamics, using feedback from the CoM states. The lower level takes into account the swing foot dynamics and generates dynamically consistent trajectories for landing at the desired time as close as possible to the desired location. To do that, we use a simplified model of the robot dynamics projected in swing foot space that takes into account joint torque constraints as well as the friction cone constraints of the stance foot. We show the effectiveness of our proposed control framework by implementing robust walking patterns on our torque-controlled and open-source biped robot, Bolt. We report extensive simulations and real robot experiments in the presence of various disturbances and uncertainties.}, 
 number={2}, 
 journal={IEEE Robotics and Automation Letters}, 
 author={Daneshmand, E and Khadiv, M and Grimminger, F and Righetti, L}, 
 year={2021}, 
 month={Apr}, 
 pages={2349–2356} 
}
 @article{Grimminger_Meduri_Khadiv_Viereck_Wüthrich_Naveau_Berenz_Heim_Widmaier_Flayols_et al._2020, 
 title={An Open Torque-Controlled Modular Robot Architecture for Legged Locomotion Research}, 
 volume={5}, 
 url={https://arxiv.org/abs/1910.00093}, 
 DOI={10.1109/LRA.2020.2976639}, 
 abstract={We present a new open-source torque-controlled legged robot system, with a low-cost and low-complexity actuator module at its core. It consists of a high-torque brushless DC motor and a low-gear-ratio transmission suitable for impedance and force control. We also present a novel foot contact sensor suitable for legged locomotion with hard impacts. A 2.2 kg quadruped robot with a large range of motion is assembled from eight identical actuator modules and four lower legs with foot contact sensors. Leveraging standard plastic 3D printing and off-the-shelf parts results in a lightweight and inexpensive robot, allowing for rapid distribution and duplication within the research community. We systematically characterize the achieved impedance at the foot in both static and dynamic scenarios, and measure a maximum dimensionless leg stiffness of 10.8 without active damping, which is comparable to the leg stiffness of a running human. Finally, to demonstrate the capabilities of the quadruped, we present a novel controller which combines feedforward contact forces computed from a kino-dynamic optimizer with impedance control of the center of mass and base orientation. The controller can regulate complex motions while being robust to environmental uncertainty.}, 
 number={2}, 
 journal={IEEE Robotics and Automation Letters}, 
 author={Grimminger, F and Meduri, A. and Khadiv, M and Viereck, J. and Wüthrich, M. and Naveau, M. and Berenz, V. and Heim, S. and Widmaier, F. and Flayols, T. and Fiene, J. and Badri-Spröwitz, A. and Righetti, L.}, 
 year={2020}, 
 month={Apr}, 
 pages={3655–3662} 
}
 @article{Hammoud_Khadiv_Righetti_2021, 
 title={Impedance Optimization for Uncertain Contact Interactions Through Risk Sensitive Optimal Control}, 
 volume={6}, 
 url={https://arxiv.org/abs/2011.04684}, 
 DOI={10.1109/LRA.2021.3068951}, 
 abstract={This paper addresses the problem of computing optimal impedance schedules for legged locomotion tasks involving complex contact interactions. We formulate the problem of impedance regulation as a trade-off between disturbance rejection and measurement uncertainty. We extend a stochastic optimal control algorithm known as Risk Sensitive Control to take into account measurement uncertainty and propose a formal way to include such uncertainty for unknown contact locations. The approach can efficiently generate optimal state and control trajectories along with local feedback control gains, i.e. impedance schedules. Extensive simulations demonstrate the capabilities of the approach in generating meaningful stiffness and damping modulation patterns before and after contact interaction. For example, contact forces are reduced during early contacts, damping increases to anticipate a high impact event and tracking is automatically traded-off for increased stability. In particular, we show a significant improvement in performance during jumping and trotting tasks with a simulated quadruped robot.}, 
 number={3}, 
 journal={IEEE Robotics and Automation Letters}, 
 author={Hammoud, B. and Khadiv, M. and Righetti, L.}, 
 year={2021}, 
 month={Jul}, 
 pages={4766–4773} 
}
 @article{Hammoud_Oliveri_Righetti_Carpentier_Del Prete_2022, 
 title={Exponential Integration for Efficient and Accurate Multi-Body Simulation with Stiff Viscoelastic Contacts}, 
 volume={54}, 
 url={https://arxiv.org/abs/2101.06846}, 
 DOI={https://doi.org/10.1007/s11044-022-09818-z}, 
 abstract={The simulation of multibody systems with frictional contacts is a fundamental tool for many fields, such as robotics, computer graphics, and mechanics. Hard frictional contacts are particularly troublesome to simulate because they make differential equations stiff, calling for computationally demanding implicit integration schemes. We suggest to tackle this issue by using exponential integrators, a long-standing class of integration schemes (first introduced in the 1960s) that in recent years has enjoyed a resurgence of interest. This scheme can be applied to multibody systems subject to stiff viscoelastic contacts, leading to integration errors similar to implicit Euler, but at much lower computational costs (between 2 to 100 times faster). In our tests with quadruped and biped robots, our method demonstrated a stable behavior with large time steps (10 ms) and stiff contacts (105 N/m). Its excellent properties, especially for fast and coarse simulations, make it a valuable candidate for many applications in robotics, such as simulation, model predictive control, reinforcement learning, and controller design.}, 
 journal={Multibody System Dynamics}, 
 author={Hammoud, Bilal and Oliveri, Luca and Righetti, Ludovic and Carpentier, Justin and Del Prete, Andrea}, 
 year={2022}, 
 month={Apr}, 
 pages={443–460} 
}
 @article{Herzog_Rotella_Mason_Grimminger_Schaal_Righetti_2016, 
 title={Momentum Control with Hierarchical Inverse Dynamics on a Torque-Controlled Humanoid}, 
 volume={40}, 
 url={https://arxiv.org/abs/1410.7284}, 
 DOI={10.1007/s10514-015-9476-6}, 
 abstract={Hierarchical inverse dynamics based on cascades of quadratic programs have been proposed for the control of legged robots. They have important benefits but to the best of our knowledge have never been implemented on a torque controlled humanoid where model inaccuracies, sensor noise and real-time computation requirements can be problematic. Using a reformulation of existing algorithms, we propose a simplification of the problem that allows to achieve real-time control. Momentum-based control is integrated in the task hierarchy and a LQR design approach is used to compute the desired associated closed-loop behavior and improve performance. Extensive experiments on various balancing and tracking tasks show very robust performance in the face of unknown disturbances, even when the humanoid is standing on one foot. Our results demonstrate that hierarchical inverse dynamics together with momentum control can be efficiently used for feedback control under real robot conditions.}, 
 number={3}, 
 journal={Autonomous Robots}, 
 author={Herzog, A. and Rotella, N and Mason, S and Grimminger, F and Schaal, S. and Righetti, L.}, 
 year={2016}, 
 month={Mar}, 
 pages={473–491} 
}
 @article{Khadiv_Herzog_Moosavian_Righetti_2020, 
 title={Walking Control Based on Step Timing Adaptation}, 
 volume={36}, 
 url={https://arxiv.org/pdf/1704.01271.pdf}, 
 DOI={10.1109/TRO.2020.2982584}, 
 abstract={Step adjustment can improve the gait robustness of biped robots; however, the adaptation of step timing is often ne- glected as it gives rise to nonconvex problems when optimized over several footsteps. In this article, we argue that it is not necessary to optimize walking over several steps to ensure gait viability and show that it is sufficient to merely select the next step timing and location. Using this insight, we propose a novel walking pattern generator that optimally selects step location and timing at every control cycle. Our approach is computationally simple compared to standard approaches in the literature, yet guarantees that any viable state will remain viable in the future. We propose a swing foot adaptation strategy and integrate the pattern generator with an inverse dynamics controller that does not explicitly control the center of mass nor the foot center of pressure. This is particularly useful for biped robots with limited control authority over their foot center of pressure, such as robots with point feet or passive ankles. Extensive simulations on a humanoid robot with passive ankles demonstrate the capabilities of the approach in various walking situations, including external pushes and foot slippage, and emphasize the importance of step timing adaptation to stabilize walking.}, 
 number={3}, 
 journal={IEEE Transactions on Robotics}, 
 author={Khadiv, M and Herzog, A. and Moosavian, S A A and Righetti, L}, 
 year={2020}, 
 month={Apr}, 
 pages={629–643} 
}
 @inproceedings{Meduri_Khadiv_Righetti_2021, 
 address={Xi’an, China}, 
 title={DeepQ Stepper: A Framework for Reactive Dynamic Walking on Uneven Terrain}, 
 url={https://arxiv.org/abs/2010.14834}, 
 DOI={10.1109/ICRA48506.2021.9562093}, 
 abstract={Reactive stepping and push recovery for biped robots is often restricted to ﬂat terrains because of the difﬁculty in computing capture regions for nonlinear dynamic models. In this paper, we address this limitation by proposing a novel 3D reactive stepper, the DeepQ stepper, that can approximately learn the 3D capture regions of both simpliﬁed and full robot dynamic models using reinforcement learning, which can then be used to ﬁnd optimal steps. The stepper can take into account the entire dynamics of the robot, ignored in most reactive steppers, leading to a signiﬁcant improvement in performance. The DeepQ stepper can handle nonconvex terrain with obstacles, walk on restricted surfaces like stepping stones while tracking different velocities, and recover from external disturbances for a constant low computational cost.}, 
 booktitle={2021 IEEE-RAS International Conference on Robotics and Automation (ICRA)}, 
 publisher={IEEE}, 
 author={Meduri, Avadesh and Khadiv, Majid and Righetti, Ludovic}, 
 year={2021}, 
 month={May} 
}
 @article{Meduri_Shah_Viereck_Khadiv_Havoutis_Righetti_2023, 
 title={BiConMP: A Nonlinear Model Predictive Control Framework for Whole Body Motion Planning}, 
 url={https://arxiv.org/abs/2201.07601}, 
 DOI={10.1109/TRO.2022.3228390}, 
 abstract={Online planning of whole-body motions for legged robots is challenging due to the inherent nonlinearity in the robot dynamics. In this work, we propose a nonlinear model predictive control (MPC) framework, the BiConMP which can generate whole body trajectories online by efficiently exploiting the structure of the robot dynamics. BiConMP is used to generate various cyclic gaits on a real quadruped robot and its performance is evaluated on different terrain, countering unforeseen pushes, and transitioning online between different gaits. Furthermore, the ability of BiConMP to generate nontrivial acyclic whole-body dynamic motions on the robot is presented. The same approach is also used to generate various dynamic motions in MPC on a humanoid robot (Talos) and another quadruped robot (AnYmal) in simulation. Finally, an extensive empirical analysis on the effects of planning horizon and frequency on the nonlinear MPC framework is reported and discussed.}, 
 journal={IEEE Transactions on Robotics}, 
 author={Meduri, Avadesh and Shah, Paarth and Viereck, Julian and Khadiv, Majid and Havoutis, Ioannis and Righetti, Ludovic}, 
 year={2023}, 
 pages={1–18} 
}
 @article{Ponton_Khadiv_Meduri_Righetti_2021, 
 title={Efficient Multi-Contact Pattern Generation with Sequential Convex Approximations of the Centroidal Dynamics}, 
 volume={37}, 
 url={https://arxiv.org/abs/2010.01215}, 
 DOI={10.1109/TRO.2020.3048125}, 
 abstract={This paper investigates the problem of efficient computation of physically consistent multi-contact behaviors. Recent work showed that under mild assumptions, the problem could be decomposed into simpler kinematic and centroidal dynamic optimization problems. Based on this approach, we propose a general convex relaxation of the centroidal dynamics leading to two computationally efficient algorithms based on iterative resolutions of second order cone programs. They op- timize centroidal trajectories, contact forces and, importantly, the timing of the motions. We include the approach in a kino- dynamic optimization method to generate full-body movements. Finally, the approach is embedded in a mixed-integer solver to further find dynamically consistent contact sequences. Extensive numerical experiments demonstrate the computational efficiency of the approach, suggesting that it could be used in a fast receding horizon control loop. Executions of the planned motions on simulated humanoids and quadrupeds and on a real quadruped robot further show the quality of the optimized motions.}, 
 number={5}, 
 journal={IEEE Transactions on Robotics}, 
 author={Ponton, B and Khadiv, M and Meduri, A. and Righetti, L}, 
 year={2021}, 
 month={Feb}, 
 pages={1661–1679} 
}
 @inproceedings{Viereck_Meduri_Righetti_2022, 
 series={Proceedings of Machine Learning Research}, 
 title={ValueNetQP: Learned one-step optimal control for legged locomotion}, 
 volume={168}, 
 url={https://proceedings.mlr.press/v168/viereck22a.html}, 
 abstract={Optimal control is a successful approach to generate motions for complex robots, in particular for legged locomotion. However, these techniques are often too slow to run in real time for model predictive control or one needs to drastically simplify the dynamics model. In this work, we present a method to learn to predict the gradient and hessian of the problem value function, enabling fast resolution of the predictive control problem with a one-step quadratic program. In addition, our method is able to satisfy constraints like friction cones and unilateral constraints, which are important for high dynamics locomotion tasks. We demonstrate the capability of our method in simulation and on a real quadruped robot performing trotting and bounding motions.}, 
 booktitle={Proceedings of The 4th Annual Learning for Dynamics and Control Conference}, 
 publisher={PMLR}, 
 author={Viereck, Julian and Meduri, Avadesh and Righetti, Ludovic}, 
 year={2022}, 
 month={Jun}, 
 pages={931--942}, 
 collection={Proceedings of Machine Learning Research} 
}
 @inproceedings{Viereck_Righetti_2021, 
 address={Xi’an, China}, 
 title={Learning a Centroidal Motion Planner for Legged Locomotion}, 
 url={https://arxiv.org/abs/2011.02818}, 
 DOI={10.1109/ICRA48506.2021.9562022}, 
 abstract={Whole-body optimizers have been successful at automatically computing complex dynamic locomotion behaviors. However they are often limited to ofﬂine planning as they are computationally too expensive to replan with a high frequency. Simpler models are then typically used for online replanning. In this paper we present a method to generate whole body movements in real-time for locomotion tasks. Our approach consists in learning a centroidal neural network that predicts the desired centroidal motion given the current state of the robot and a desired contact plan. The network is trained using an existing whole body motion optimizer. Our approach enables to learn with few training samples dynamic motions that can be used in a complete whole-body control framework at high frequency, which is usually not attainable with typical full-body optimizers. We demonstrate our method to generate a rich set of walking and jumping motions on a real quadruped robot.}, 
 booktitle={2021 IEEE-RAS International Conference on Robotics and Automation (ICRA)}, 
 publisher={IEEE}, 
 author={Viereck, Julian and Righetti, Ludovic}, 
 year={2021}, 
 month={May} 
}
 @article{Yeganegi_Khadiv_Del Prete_Moosavian_Righetti_2022, 
 title={Robust walking based on MPC with viability-based feasibility guarantees}, 
 volume={38}, 
 url={https://arxiv.org/abs/2010.04514}, 
 DOI={10.1109/TRO.2021.3127388}, 
 abstract={Model predictive control (MPC) has shown great success for controlling complex systems, such as legged robots. However, when closing the loop, the performance and feasibility of the finite horizon optimal control problem (OCP) solved at each control cycle are not guaranteed anymore. This is due to model discrepancies, the effect of low-level controllers, uncertainties, and sensor noise. To address these issues, we propose a modified version of a standard MPC approach used in legged locomotion with viability (weak forward invariance) guarantees. In this approach, instead of adding a (conservative) terminal constraint to the problem, we propose to use the measured state projected to the viability kernel in the OCP solved at each control cycle. Moreover, we use past experimental data to find the best cost weights, which measure a combination of performance, constraint satisfaction robustness, or stability (invariance). These interpretable costs measure the tradeoff between robustness and performance. For this purpose, we use Bayesian optimization to systematically design experiments that help efficiently collect data to learn a cost function leading to robust performance. Our simulation results with different realistic disturbances (i.e., external pushes, unmodeled actuator dynamics, and computational delay) show the effectiveness of our approach to create robust controllers for humanoid robots.}, 
 number={4}, 
 journal={IEEE Transactions on Robotics}, 
 author={Yeganegi, Mohammad Hasan and Khadiv, Majid and Del Prete, Andrea and Moosavian, S Ali A and Righetti, Ludovic}, 
 year={2022}, 
 pages={2389–2404} 
}
