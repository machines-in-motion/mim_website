 @article{Daneshmand_Khadiv_Grimminger_Righetti_2021, 
 title={Variable Horizon MPC with Swing Foot Dynamics for Bipedal Walking Control}, 
 volume={6}, 
 url={https://arxiv.org/abs/2010.08198}, 
 DOI={10.1109/LRA.2021.3061381}, 
 abstract={In this paper, we present a novel two-level variable Horizon Model Predictive Control (VH-MPC) framework for bipedal locomotion. In this framework, the higher level computes the landing location and timing (horizon length) of the swing foot to stabilize the unstable part of the center of mass (CoM) dynamics, using feedback from the CoM states. The lower level takes into account the swing foot dynamics and generates dynamically consistent trajectories for landing at the desired time as close as possible to the desired location. To do that, we use a simplified model of the robot dynamics projected in swing foot space that takes into account joint torque constraints as well as the friction cone constraints of the stance foot. We show the effectiveness of our proposed control framework by implementing robust walking patterns on our torque-controlled and open-source biped robot, Bolt. We report extensive simulations and real robot experiments in the presence of various disturbances and uncertainties.}, 
 number={2}, 
 journal={IEEE Robotics and Automation Letters}, 
 author={Daneshmand, E and Khadiv, M and Grimminger, F and Righetti, L}, 
 year={2021}, 
 month={Apr}, 
 pages={2349–2356} 
}
 @inproceedings{Kleff_Dantec_Saurel_Mansard_Righetti_2022, 
 address={Kyoto, Japan}, 
 title={Introducing Force Feedback in Model Predictive Control}, 
 url={https://hal.archives-ouvertes.fr/hal-03594295/document}, 
 DOI={10.1109/IROS47612.2022.9982003}, 
 abstract={In the literature about model predictive control (MPC), contact forces are planned rather than controlled. In this paper, we propose a novel paradigm to incorporate effort measurements into a predictive controller, hence allowing to control them by direct measurement feedback. We first demonstrate why the classical optimal control formulation, based on position and velocity state feedback, cannot handle direct feedback on force information. Following previous approaches in force control, we then propose to augment the classical formulations with a model of the robot actuation, which naturally allows to generate online trajectories that adapt to sensed position, velocity and torques. We propose a complete implementation of this idea on the upper part of a real humanoid robot, and show through hardware experiments that this new formulation incorporating effort feedback outperforms classical MPC in challenging tasks where physical interaction with the environment is crucial.}, 
 booktitle={2022 IEEE/RSJ International Conference on Intelligent Robots and Systems}, 
 publisher={IEEE}, 
 author={Kleff, Sebastien and Dantec, Ewen and Saurel, Guilhem and Mansard, Nicolas and Righetti, Ludovic}, 
 year={2022}, 
 month={Oct} 
}
 @inproceedings{Kleff_Mansard_Righetti_2022, 
 address={Okinawa, Japan}, 
 title={On the Derivation of the Contact Dynamics in Arbitrary Frames (Application to Polishing with Talos)}, 
 url={https://hal.archives-ouvertes.fr/hal-03758989/}, 
 DOI={10.1109/Humanoids53995.2022.10000208}, 
 abstract={Contact dynamics relies on the simultaneous satisfaction of constraints at the robot body level and at the contact level. At both levels, various formulations can be chosen that all must lead to the same results, given the same hypothesis, hence the little importance of their details. Yet when using it in an optimal control problem, a particular formulation is often imposed by the task to be performed by the robot. In this paper, we detail the formulation of the contact quantities (force, movement) in an arbitrary frame imposed by the task. In that case, we will show that we are typically not interested in working in the local frame (attached to the robot contact point), nor in the world frame, but in a user-defined frame centered at the contact location with a fixed orientation in the world. The derivations can then be used for 6D, 3D or normal (pure-sliding) contact. We implemented the corresponding derivatives on top of the contact dynamics of Pinocchio in the optimal control solver Crocoddyl. In order to show that a unique formulation is able to handle several operational orientations, we achieved several surfacing tasks in model predictive control with the robot Talos.}, 
 booktitle={IEEE-RAS International Conference on Humanoid Robots}, 
 publisher={IEEE}, 
 author={Kleff, Sébastien and Mansard, Nicolas and Righetti, Ludovic}, 
 year={2022} 
}
 @inproceedings{Kleff_Meduri_Budhiraja_Mansard_Righetti_2021, 
 address={Xi’an, China}, 
 title={High-Frequency Nonlinear Model Predictive Control of a Manipulator}, 
 url={https://hal.archives-ouvertes.fr/hal-02993058/document}, 
 DOI={10.1109/ICRA48506.2021.9560990}, 
 abstract={Model Predictive Control (MPC) promises to endow robots with enough reactivity to perform complex tasks in dynamic environments by frequently updating their motion plan based on measurements. Despite its appeal, it has seldom been deployed on real machines because of scaling constraints. This paper presents the ﬁrst hardware implementation of closed-loop nonlinear MPC on a 7-DoF torque-controlled robot. Our controller leverages a state-of-the art optimal control solver, namely Differential Dynamic Programming (DDP), in order to replan state and control trajectories at real-time rates (1kHz). In addition to this experimental proof of concept, an exhaustive performance analysis shows that our controller outperforms open-loop MPC on a rapid cyclic end-effector task. We also exhibit the importance of a sufﬁcient preview horizon and full robot dynamics through comparisons with inverse dynamics and kinematic optimization.}, 
 booktitle={2021 IEEE-RAS International Conference on Robotics and Automation (ICRA)}, 
 publisher={IEEE}, 
 author={Kleff, Sebastien and Meduri, Avadesh and Budhiraja, Rohan and Mansard, Nicolas and Righetti, Ludovic}, 
 year={2021}, 
 month={May} 
}
 @article{Meduri_Shah_Viereck_Khadiv_Havoutis_Righetti_2023, 
 title={BiConMP: A Nonlinear Model Predictive Control Framework for Whole Body Motion Planning}, 
 url={https://arxiv.org/abs/2201.07601}, 
 DOI={10.1109/TRO.2022.3228390}, 
 abstract={Online planning of whole-body motions for legged robots is challenging due to the inherent nonlinearity in the robot dynamics. In this work, we propose a nonlinear model predictive control (MPC) framework, the BiConMP which can generate whole body trajectories online by efficiently exploiting the structure of the robot dynamics. BiConMP is used to generate various cyclic gaits on a real quadruped robot and its performance is evaluated on different terrain, countering unforeseen pushes, and transitioning online between different gaits. Furthermore, the ability of BiConMP to generate nontrivial acyclic whole-body dynamic motions on the robot is presented. The same approach is also used to generate various dynamic motions in MPC on a humanoid robot (Talos) and another quadruped robot (AnYmal) in simulation. Finally, an extensive empirical analysis on the effects of planning horizon and frequency on the nonlinear MPC framework is reported and discussed.}, 
 journal={IEEE Transactions on Robotics}, 
 author={Meduri, Avadesh and Shah, Paarth and Viereck, Julian and Khadiv, Majid and Havoutis, Ioannis and Righetti, Ludovic}, 
 year={2023}, 
 pages={1–18} 
}
 @inproceedings{Meduri_Zhu_Jordana_Righetti_2023, 
 address={London, UK}, 
 title={MPC with Sensor-Based Online Cost Adaptation}, 
 url={http://arxiv.org/abs/2209.09451}, 
 abstract={Model predictive control is a powerful tool to generate complex motions for robots. However, it often requires solving non-convex problems online to produce rich behaviors, which is computationally expensive and not always practical in real time. Additionally, direct integration of high dimensional sensor data (e.g. RGB-D images) in the feedback loop is challenging with current state-space methods. This paper aims to address both issues. It introduces a model predictive control scheme, where a neural network constantly updates the cost function of a quadratic program based on sensory inputs, aiming to minimize a general non-convex task loss without solving a non-convex problem online. By updating the cost, the robot is able to adapt to changes in the environment directly from sensor measurement without requiring a new cost design. Furthermore, since the quadratic program can be solved efﬁciently with hard constraints, a safe deployment on the robot is ensured. Experiments with a wide variety of reaching tasks on an industrial robot manipulator demonstrate that our method can efﬁciently solve complex non-convex problems with highdimensional visual sensory inputs, while still being robust to external disturbances.}, 
 note={arXiv:2209.09451 [cs]}, 
 booktitle={2023 IEEE-RAS International Conference on Robotics and Automation (ICRA)}, 
 publisher={IEEE}, 
 author={Meduri, Avadesh and Zhu, Huaijiang and Jordana, Armand and Righetti, Ludovic}, 
 year={2023}, 
 month={May} 
}
 @inproceedings{Viereck_Meduri_Righetti_2022, 
 series={Proceedings of Machine Learning Research}, 
 title={ValueNetQP: Learned one-step optimal control for legged locomotion}, 
 volume={168},
 url={https://proceedings.mlr.press/v168/viereck22a.html}, 
 abstract={Optimal control is a successful approach to generate motions for complex robots, in particular for legged locomotion. However, these techniques are often too slow to run in real time for model predictive control or one needs to drastically simplify the dynamics model. In this work, we present a method to learn to predict the gradient and hessian of the problem value function, enabling fast resolution of the predictive control problem with a one-step quadratic program. In addition, our method is able to satisfy constraints like friction cones and unilateral constraints, which are important for high dynamics locomotion tasks. We demonstrate the capability of our method in simulation and on a real quadruped robot performing trotting and bounding motions.}, 
 booktitle={Proceedings of The 4th Annual Learning for Dynamics and Control Conference}, 
 publisher={PMLR}, 
 author={Viereck, Julian and Meduri, Avadesh and Righetti, Ludovic}, 
 year={2022}, 
 month={Jun}, 
 pages={931--942}, 
 collection={Proceedings of Machine Learning Research} 
}
